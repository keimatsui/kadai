ドミニオンのオンライン対戦用ツールです。 ver 3.0.0.0
ご使用は自己責任でお願いします。

動作には.Net Framework3.5 が必須です。
Windows Vista 以降は標準搭載されているようですが、Windows XP 以前の場合はMicrosoft Update等からインストールしてください。
Windows 2000 以前のOSには.Net Framework3.5がインストールできないため起動できません。
なお .Net Framework4.0 は .Net Framework3.5 の上位互換がありません。

キーボードには非対応。

要望には後ろ向きに善処します。

------------------------------

☆このツールについて
最大4人×9卓まで対戦できます。
基本・陰謀・海辺・錬金術・繁栄・収穫祭・異郷・暗黒時代・ギルド・プロモ・αに対応してます。
クライアントが落ちても途中復帰が可能です。




☆内容物
・Dominion_Server.exe　　　サーバ本体
・Dominion_Client.exe　　　クライアント本体
・Dominion_Preset.exe　　　（とても使いにくい）プリセット設定プログラム（非サーバ接続）
・Dominion_List.exe　　　　並べたカードを見てニヨニヨするだけ（非サーバ接続）
・Imageフォルダ　　　　　　カード画像フォルダ
・Soundフォルダ　　　　　　効果音フォルダ
・Logフォルダ　　　　　　　ログを残す場合に作成してください
・ToolTipフォルダ　　　　　ツールチップに画像を表示したい場合は作成してください（詳細は113行目あたり）

・setting.xml　　　　　　　設定ファイル（自動作成）
・preset.xml 　　　　　　　プリセット設定（自動作成）




☆使い方
　・サーバを立てる
　　　Dominion_Server.exeを起動し、サーバ名とポートNoを指定してください。（TCP通信）
　　　ポート開放などは自分で調べてください。（自己責任でお願いします。）

　・クライアントで接続
　　　Dominion_Client.exeを起動し、サーバが起動しているIPアドレスとポートNoを指定してください。
　　　DNS名での接続はやったことがないので不明です。

※サーバとクライアントのverが違うと弾かれます。

基本的にはガイド文に沿ってマウス操作できると思います。

プレイヤーパネルにマウスカーソルを合わせると、各プレイヤーの捨て札の一番上のカード、前ターンに獲得したカード、
持続カード、脇に置いているカード、島マットのカード、原住民の村マットのカードを表示します。




☆サーバの設定
　●チャット通信　[ 許可 / 禁止 ]
　　チャットによる会話を許可するかどうか

　●観戦者の席移動　[ 許可 / 禁止 ]
　　ゲームに参加していない人がゲーム中のプレイヤーと同じ視点で見ることを許可するかどうか

　●サプライ設定の変更　[ 許可 / 禁止 ]
　　サプライ設定の変更を許可するかどうか

　●オリジナルカードの使用　[ 解禁 / 封印 ]
　　本家のカードではないファンカードを使用するかどうか

　●接続メッセージ設定
　　サーバに接続したクライアントに対してメッセージを送る場合に入力してください。
　　空欄でボタンを押すと接続メッセージを解除できます。

　●接続リスト
　接続プレイヤー名を選択し右クリックで「切断」を選ぶと、そのクライアントを強制切断します。

　●ログ
　　Dominion_Server.exeと同じディレクトリに Log フォルダがある場合、ゲーム終了時に簡易ゲーム結果を残します。

サーバの設定は全てsetting.xmlに保存されます。



　●起動画面省略
　　setting.xmlをテキストエディタで開き
　　　　<ServerInitOmit>false</ServerInitOmit>
　　とあるところを
　　　　<ServerInitOmit>true</ServerInitOmit>
　　に変更すると、起動時のサーバ設定画面を省略してサーバを起動します。


　●複数卓設定
　　setting.xmlをテキストエディタで開き、61行目（自動財宝設定数によってはもっと後ろのほう）あたりにある
　　　　<GameBoardCount>1</GameBoardCount>
　　の真ん中の数字を1〜9の数値に変更して保存します。
　　
　　その後、クライアントで接続すると、卓一覧のサブウィンドウが表示されます。
　　メニューの その他 ＞ 卓一覧ウィンドウ表示 でも表示することが可能です。
　　卓一覧ウィンドウでの色は
　　　・青：ゲームしてないよ
　　　・赤：ゲーム中よ
　　　・黄：ゲーム終了したよ
　　チャット入力欄横のボタンでどの人にチャット送信するかを選択します。（Enterキーで送信する時に押されているボタンに準拠）
　　
　　なお、ゲーム中のプレイヤー、席に着いているプレイヤーは卓移動不可です。
　　また、サーバ側の設定（オリジナルカードの使用 など）は全卓一括設定となります。




☆クライアントのいろいろ
・ツールチップに画像を表示したい場合は、Dominion_Client.exeと同じディレクトリに ToolTip フォルダを作成し、
　そこに画像を放り込んでください。画像のファイル名やフォルダ構造は Image フォルダと同じです。

・卓にコメント（説明文）をつけたい場合は、卓一覧のサブウィンドウで卓を右クリックしてください

・プレイ場の赤丸は はみだし者 がなりすましているカードです。

・手札の右側は捨て札の一番上表示です。アタックで廃墟を獲得させられた時にわかりにくいので表示。玉座で打たれたときは知りません。

・サプライカード設定を画像で表示したい場合は、setting.xmlをテキストエディタで開き
　　　<IsViewImageSettingCard>false</IsViewImageSettingCard>
　を
　　　<IsViewImageSettingCard>true</IsViewImageSettingCard>
　に変更。




☆本家ルールとの相違
・前哨地ターンと支配ターンが同時に発生する場合は、前哨地ターンが優先的に開始されます。
　（本家ルールではプレイヤーが選択）

・推奨王国カードの日本語版、「辻強盗」と「公爵の舞踏会」のNoble Brigandが遊牧民の野営地になっているのは私だけ？




☆プリセット設定
preset.xmlを直接編集することも可能ですが、書式やカード名が1文字でも間違うと読み込みできなくなりますので自己責任でお願いします。
プリセット指定中のサプライ設定は除外カードのみ有効（闇市場デッキの作成条件）です。




☆駄文
数人接続の数時間起動でしか試していないので、ずっと起動しっぱなしだとメモリリーク等が発生しているかもしれません。

exeアイコン募集中。




☆使用素材
効果音にザ・マッチメイカァズ2ndの物を使用させて頂きました。
http://osabisi.sakura.ne.jp/m2/




------------------------------
☆その他
Ｑ．リプレイは？
Ａ．そのような高等機能はありません。

Ｑ．setting.xmlに書き込みに失敗しました　preset.xmlの書き込みに失敗しました　って？
Ａ．文字通りxmlファイルが書き込みできなかった場合にでます。
　　ファイルが読み取り専用、起動フォルダの書き込み権限がない、Vista以降でUACが働いているなどが原因です。
　　アクセス権限を変更するか、UACが働かないフォルダで起動するようお願いします。

Ｑ．重いっ！
Ａ．ゲームプログラマではないのでこれが限界です。

Ｑ．サーバのメモリの食い方が尋常じゃない
Ａ．.Net Frameworkを使用するプログラムは起動時間が長いほどメモリを消費するのが仕様なのでどうしようもありません。
　　ただ、メモリ不足に陥るほど使用する訳ではないので、どうしても気になるのならば適宜再起動してください。
　　（本当にメモリリークが発生しているかもしれませんが）

Ｑ．カード設定で除外しまくったけど1個ずつ戻すのが面倒
Ａ．各カード名の上で右クリックすると、そのセットを一括で操作できます。

Ｑ．観戦中に各プレイヤーの手札が見たい
Ａ．サーバ側の設定で禁止されていなければ、左側のプレイヤーパネルをクリックすることでそのプレイヤー自身の画面を表示します。
　　プレイヤーパネルに S と□で囲まれている箇所が現在の視点です。
　　原住民の村マットなど、プレイヤー自身のみの公開情報も表示されます。
　　ボタン等も表示されますが、クリックしても何も起きません。（何か起きたならばバグです）
　　なお、再度同じプレイヤーパネルをクリックするとニュートラルの状態に戻ります。

Ｑ．銅貨5枚で始まると、屋敷なのか避難所なのかわからないんだけど
Ａ．ゲーム開始時のシステムチャット出力に、避難所を使用している場合は「初期デッキは避難所です」と出ます。

Ｑ．財宝を1枚ずつクリックするのが面倒
Ａ．プレイ場の左側のオレンジ色の部分（Act:とか書いてある所）をクリックすると財宝を一括使用します。

Ｑ．ハーレムや白金貨も一括で使用したいんだけど
Ａ．メニューバー の 設定 の 財宝一括使用設定 で一括で使用する財宝カードを設定してください。
　　ゲーム中いつでも変更可能です。

Ｑ．コイントークン持っていると財宝フェイズを一々終了させるのが面倒
Ａ．メニューバー の 設定 の 財宝フェイズに購入 にチェックを入れてください。
　　財宝フェイズ中の 購入できる サプライカードを選択したときに自動で購入フェイズに移行し、
　　そのまま選択したカードを購入することができます。

Ｑ．魔女娘や馬上槍試合でいちいち公開するか聞いてくるのがウザイ
Ａ．メニューバー の 設定 の 公開選択肢表示設定 で選択肢を表示する条件を設定してください。
　　ゲーム中いつでも変更可能です。

Ｑ．支配中にアタックカードを使ったら操作できなくなった！
Ａ．支配プレイヤー自身に対して効果が発動しているので、プレイヤーパネルをクリックして自分の席に移動してください。
　　特に獲得時効果があるカードは、プログラムが止まったと錯覚しやすいので注意してください。

Ｑ．闇市場デッキを表示している時にサプライの状態を見たい
Ａ．闇市場を使用している時のみ、左下の「闇市場プレイ中」と表示されているところにマウスカーソルを合わせると、
　　一時的に闇市場デッキを非表示にします。

Ｑ．何かエラーメッセージが出た！でも、チャットはできる？
Ａ．ゲーム部分とチャット部分は完全に切り離しているので、ゲーム部分が死んでもチャットはできます。
　　ただし、ゲーム部分の描画更新が一切行われないので、クライアントを再起動してください。
　　なお、エラーメッセージが表示された状態をスクリーンショットなどで報告していただけると、直せるかもしれません。
　　再起動してもエラーが出る場合はどうしようもないので、申し訳ありませんがサーバを再起動してください。

Ｑ．各卓のコメント（説明文）って消せないの？空白でＯＫしても反映されない！
Ａ．.Netの仕様上、空白確定とキャンセルの区別がつかない糞仕様なので空白はキャンセル扱いにしています。
　　コメントを消したい場合、スペースのみで送信すれば見かけ上は消えます。

Ｑ．エラーメッセージは出ないけど操作を受け付けなくなった
Ａ．まず再起動してください。そのときに「☆送信エラーのため〜〜を切断しました」というメッセージが出た場合は
　　正常なTCP/IP通信ができずにクライアントの終了を検知できなかったということになります。
　　無線接続などで接続が不安定だと現象がでるようなので有線でネットワークに繋ぐなど、ネットワークの接続を安定させてください。

Ｑ．操作がメンドくさい
Ａ．ホビージャパンから日本語版が発売されていますので、是非購入して遊びましょう。
　　お好きな操作でゲームすることが可能です。
　　ボードゲームショップや東急ハンズで買えるようです。